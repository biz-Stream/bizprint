# bizprint エラーコード一覧

bizprint クライアントが返すエラーコードおよびステータスコードのリファレンスです。

## エラーコード体系

| 範囲 | 分類 | エラー種別 (ERROR_CAUSE) |
|------|------|--------------------------|
| 01xx | データ関連エラー | DATA |
| 02xx | ライブラリ関連エラー | LIBRARY |
| 03xx | ファイル関連エラー | FILE |
| 04xx | 印刷関連エラー | PRINT |
| 05xx | その他のエラー | OTHER |

正常終了時はエラーコード `0000`、ERROR_CAUSE は空文字列です。

---

## 01xx: データ関連エラー (DATA)

spp ファイルの取得・解析や印刷パラメータの検証で発生するエラーです。

| コード | メッセージ | 原因 | 対処法 |
|--------|-----------|------|--------|
| 0101 | sppファイルを取得できない。 | サーバーから spp ファイルをダウンロードできなかった。 | サーバー側の spp ファイル生成処理およびネットワーク接続を確認する。 |
| 0102 | sppファイルを解凍できない。 | spp ファイルの解凍（復号・展開）に失敗した。 | spp ファイルが破損していないか、暗号化キーがサーバーとクライアントで一致しているか確認する。 |
| 0103 | sppファイルのサイズが異常。 | spp ファイルのサイズが想定範囲外である。 | サーバー側で正しく spp ファイルが生成されているか確認する。 |
| 0104 | sppファイルに印刷データファイルが含まれていない。 | spp ファイル内に印刷対象の PDF 等のデータが存在しない。 | サーバー側で印刷データが正しく spp ファイルに含まれているか確認する。 |
| 0105 | sppファイルに印刷パラメータファイルが含まれていない。 | spp ファイル内に印刷パラメータ定義が存在しない。 | サーバー側で印刷パラメータが正しく spp ファイルに含まれているか確認する。 |
| 0106 | プリンタ名の指定が間違っている。 | 印刷パラメータで指定されたプリンタ名がクライアント環境に存在しない。 | プリンタ名のスペルが正しいか、クライアント PC にそのプリンタがインストールされているか確認する。 |
| 0107 | デフォルトプリンタが設定されていない。 | プリンタ名の指定がなく、デフォルトプリンタも未設定である。 | クライアント PC でデフォルトプリンタを設定する。 |
| 0108 | プリンタのハンドルを取得できない。 | プリンタデバイスのハンドル取得に失敗した。 | プリンタドライバが正しくインストールされているか、プリンタがオンラインか確認する。 |
| 0109 | トレイの指定が間違っている。 | 印刷パラメータで指定されたトレイ名が不正である。 | 有効なトレイ名（FIRST, UPPER, LOWER, MIDDLE, MANUAL, ENVELOPE, AUTO 等）を指定する。 |
| 0110 | 印刷部数の指定が間違っている。 | 印刷部数に不正な値（0 以下や数値以外）が指定された。 | 印刷部数に 1 以上の正の整数を指定する。 |
| 0111 | 印刷開始・終了ページ指定が間違っている。 | 開始ページや終了ページの値が不正である。 | ページ指定が正しい範囲内であるか確認する。 |
| 0112 | レスポンスURLが間違っている。 | 印刷結果の返信先 URL が不正な形式である。 | レスポンス URL が正しい HTTP/HTTPS 形式であるか確認する。 |
| 0113 | ファイル保存パス指定が間違っている。 | 保存先のファイルパスが不正または存在しないディレクトリである。 | 保存先パスが存在し、書き込み権限があるか確認する。 |
| 0114 | 印刷キュー上限を超えたため、印刷要求を破棄した。 | 印刷要求が上限数に達し、新たな要求を受け付けられなかった。 | 印刷キューが処理されるまで待つか、キュー上限の設定値を見直す。 |
| 0115 | 接続できない、または権限が無いプリンタ名。 | 指定されたプリンタに接続できないか、アクセス権限がない。 | ネットワークプリンタへの接続やアクセス権限を確認する。 |

---

## 02xx: ライブラリ関連エラー (LIBRARY)

PDF 表示ライブラリ（Acrobat Reader）の操作時に発生するエラーです。

| コード | メッセージ | 原因 | 対処法 |
|--------|-----------|------|--------|
| 0201 | Acrobat Readerを呼び出すクラスの作成でエラー。 | Acrobat Reader の COM オブジェクト生成に失敗した。 | Acrobat Reader が正しくインストールされているか確認する。 |
| 0202 | Acrobat ReaderでのPDFファイル読み込みでエラー。 | Acrobat Reader で PDF ファイルを開く際にエラーが発生した。 | PDF ファイルが破損していないか、Acrobat Reader のバージョンが対応しているか確認する。 |
| 0203 | Acrobat Readerへの印刷指示でエラー。 | Acrobat Reader を通じた印刷実行でエラーが発生した。 | プリンタの状態や Acrobat Reader の設定を確認する。 |
| 0204 | Acrobat Readerを呼び出すクラスの削除でエラー。 | Acrobat Reader の COM オブジェクト解放に失敗した。 | Acrobat Reader のプロセスが正常に終了しているか確認する。必要に応じて Acrobat Reader のプロセスを手動で終了する。 |

---

## 03xx: ファイル関連エラー (FILE)

ファイルの保存時に発生するエラーです。

| コード | メッセージ | 原因 | 対処法 |
|--------|-----------|------|--------|
| 0301 | ファイル保存時にエラーが発生。 | 印刷データのファイル保存処理で例外が発生した。 | 保存先のディスク容量やフォルダのアクセス権限を確認する。 |
| 0302 | 印刷一時ファイル保存時にエラーが発生。 | 印刷処理用の一時ファイル作成に失敗した。 | 一時フォルダのディスク容量やアクセス権限を確認する。 |

---

## 04xx: 印刷関連エラー (PRINT)

印刷処理の実行中に発生するエラーです。

| コード | メッセージ | 原因 | 対処法 |
|--------|-----------|------|--------|
| 0401 | 印刷ダイアログ表示の場合の待ちタイムアウト。 | 印刷ダイアログの表示待ちがタイムアウトした。 | タイムアウト値の設定を見直すか、システム負荷を確認する。 |
| 0402 | 印刷ダイアログ表示を検知できない。 | 印刷ダイアログの表示を検出できなかった。 | 画面の解像度やデスクトップの設定を確認する。 |
| 0403 | スプーラからの情報取得関数が失敗。 | Windows 印刷スプーラ API の呼び出しに失敗した。 | 印刷スプーラサービスが起動しているか確認する。 |
| 0404 | スプーラから応答が無い。 | Windows 印刷スプーラから応答がない。 | 印刷スプーラサービスの状態を確認し、必要に応じて再起動する。 |
| 0405 | 複数部数の印刷がタイムアウトまでにスプールし終わらない。 | 複数部数の印刷ジョブがタイムアウト時間内に完了しなかった。 | タイムアウト値を延長するか、プリンタの処理能力を確認する。 |
| 0406 | オフライン。 | プリンタがオフライン状態である。 | プリンタの電源および接続を確認し、オンラインにする。 |
| 0407 | 用紙切れ。 | プリンタの用紙が不足している。 | プリンタに用紙を補充する。 |
| 0408 | 不正なドライバ。 | プリンタドライバが無効または不正である。 | プリンタドライバを再インストールする。 |
| 0409 | プリンタ不良。 | プリンタ本体のハードウェアエラーが発生した。 | プリンタの状態を確認し、必要に応じて修理または交換する。 |
| 0410 | 印刷受付タイムアウト。 | プリンタへの印刷ジョブ送信がタイムアウトした。 | ネットワーク接続やプリンタの応答を確認する。 |
| 0411 | トレイ指定時のプリンタアクセス権限不足。 | トレイを指定して印刷する際にプリンタへのアクセス権限が不足している。 | サービス実行ユーザーのプリンタアクセス権限を確認する。 |
| 0412 | トレイ指定時にプリンタへの書き込みに失敗。 | トレイ設定のプリンタデバイスへの書き込みに失敗した。 | プリンタドライバの設定およびアクセス権限を確認する。 |
| 0413 | 複数部数出力中にエラーが発生したため、以降の処理を中止。 | 複数部数の印刷処理中にエラーが発生し、残りの印刷を中止した。 | エラーの原因（用紙切れ、プリンタ不良等）を解消してから再度印刷する。 |

---

## 05xx: その他のエラー (OTHER)

通信エラーやシステムエラーなど、上記分類に該当しないエラーです。

| コード | メッセージ | 原因 | 対処法 |
|--------|-----------|------|--------|
| 0501 | その他のエラー。 | 分類されない例外が発生した（実行時の例外メッセージが設定される場合がある）。 | ログファイルで詳細なエラーメッセージを確認する。 |
| 0502 | 通信エラー。 | サーバーとの通信中にエラーが発生した。 | ネットワーク接続およびサーバーの稼働状態を確認する。 |
| 0503 | HTTPプロトコルエラー。 | HTTP リクエスト/レスポンスのプロトコルエラーが発生した。 | サーバーの HTTP 設定を確認する。 |
| 0504 | HTTPメソッドエラー。 | 許可されていない HTTP メソッドでリクエストを受信した。 | リクエストの HTTP メソッド（GET/POST）が正しいか確認する。 |
| 0505 | 受信データなし。 | サーバーからの応答データが空である。 | サーバー側の処理が正常に実行されているか確認する。 |
| 0506 | JobIDに対応する印刷履歴なし。 | 指定された JobID に該当する印刷履歴が見つからない。 | 正しい JobID を指定しているか確認する。 |
| 0507 | 印刷履歴なし。 | 印刷履歴データが存在しない。 | 印刷が実行された後に照会する。 |
| 0508 | ブラウザの起動に失敗しました。 | ブラウザプロセスの起動に失敗した。 | ブラウザがインストールされているか確認する。 |
| 0509 | MicrosoftEdgeの起動に失敗しました。 | Microsoft Edge の起動に失敗した。 | Microsoft Edge がインストールされているか確認する。 |

---

## バッチ印刷ステータスコード

バッチ印刷の印刷履歴で使用されるステータスコードです。印刷ジョブの進行状態を示します。

| ステータスコード | 定数名 | 状態（日本語） | 状態（英語） | 説明 |
|-----------------|--------|---------------|-------------|------|
| 0x00 | JOB_STATUS_RECIEVED | 印刷指示受信 | Receive Print Request | 印刷指示を受信した直後の状態（未使用）。 |
| 0x02 | JOB_STATUS_ACCEPT | 印刷指示受付 | Print Request Acceptance | 印刷指示が受け付けられ、印刷キュー内で順番を待っている状態。 |
| 0x04 | JOB_STATUS_PRINTING | 印刷中 | Printing in Progress | キューから取り出され、印刷処理を実行中の状態。 |
| 0x06 | JOB_STATUS_SUCCESS_FINISH | 印刷要求送信完了 | Print Request Transmission Complete | 印刷要求がプリンタへの送信を完了した状態（正常終了）。 |
| 0x08 | JOB_STATUS_ERROR_FINISH | 印刷異常終了 | Print Abnormal Termination | 印刷処理がエラーにより異常終了した状態。 |
| 0x10 | JOB_STATUS_TIMEOUT | 印刷要求送信タイムアウト | Print Request Transmission Timeout | 印刷処理がタイムアウトにより終了した状態。 |

---

## 印刷要求返信結果

印刷要求に対するレスポンスで返される結果文字列です。

| 結果文字列 | 説明 |
|-----------|------|
| SUCCESS | 印刷要求が正常に処理された。 |
| FAIL | 印刷処理が失敗した。 |
| NOT_CONNECT | プリンタに接続できなかった。 |
| QUEUE_FULL | 印刷キューが上限に達している。 |
| SERVER_ERROR | サーバー内部でエラーが発生した。 |

---

## 参照元ソースファイル

- `bizprint-client/src/BizPrintCommon/ErrCodeAndmErrMsg.cs` - エラーコード・エラーメッセージ定義
- `bizprint-client/src/BizPrintCommon/CommonConstants.cs` - 印刷ステータスコード定義
